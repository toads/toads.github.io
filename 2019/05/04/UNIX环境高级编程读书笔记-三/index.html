<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh_Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="unix,读书笔记,">










<meta name="description" content="第三章 文件I/O 本章主要讲述了5个常用函数 open、read、write、lseek、close。 以及在多进程中共享文件所用到的 dup、fcntl、sync、fsync、ioctl。">
<meta name="keywords" content="unix,读书笔记">
<meta property="og:type" content="article">
<meta property="og:title" content="UNIX环境高级编程读书笔记-三">
<meta property="og:url" content="http://toads.github.io/2019/05/04/UNIX环境高级编程读书笔记-三/index.html">
<meta property="og:site_name" content="toads&#39;s blog">
<meta property="og:description" content="第三章 文件I/O 本章主要讲述了5个常用函数 open、read、write、lseek、close。 以及在多进程中共享文件所用到的 dup、fcntl、sync、fsync、ioctl。">
<meta property="og:locale" content="zh_Hans">
<meta property="og:updated_time" content="2019-05-04T07:48:11.279Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="UNIX环境高级编程读书笔记-三">
<meta name="twitter:description" content="第三章 文件I/O 本章主要讲述了5个常用函数 open、read、write、lseek、close。 以及在多进程中共享文件所用到的 dup、fcntl、sync、fsync、ioctl。">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://toads.github.io/2019/05/04/UNIX环境高级编程读书笔记-三/">





  <title>UNIX环境高级编程读书笔记-三 | toads's blog</title>
  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-116710997-1', 'auto');
  ga('send', 'pageview');
</script>





</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh_Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">toads's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description"></h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://toads.github.io/2019/05/04/UNIX环境高级编程读书笔记-三/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="toads">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="toads's blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">UNIX环境高级编程读书笔记-三</h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-05-04T09:11:06+08:00">
                2019-05-04
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/05/04/UNIX环境高级编程读书笔记-三/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2019/05/04/UNIX环境高级编程读书笔记-三/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>第三章 文件I/O</p>
<p>本章主要讲述了5个常用函数 <code>open</code>、<code>read</code>、<code>write</code>、<code>lseek</code>、<code>close</code>。</p>
<p>以及在多进程中共享文件所用到的 <code>dup</code>、<code>fcntl</code>、<code>sync</code>、<code>fsync</code>、<code>ioctl</code>。</p>
<a id="more"></a>
<h1 id="第三章-文件I-O"><a href="#第三章-文件I-O" class="headerlink" title="第三章  文件I/O"></a>第三章  文件I/O</h1><h3 id="文件描述符"><a href="#文件描述符" class="headerlink" title="文件描述符"></a>文件描述符</h3><table>
<thead>
<tr>
<th style="text-align:center">文件描述符</th>
<th>符号常量</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0</td>
<td>STDIN_FILENO</td>
<td>标准输入</td>
</tr>
<tr>
<td style="text-align:center">1</td>
<td>STDOUT_FILENO</td>
<td>标准输出</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td>STDERR_FILENO</td>
<td>标准错误</td>
</tr>
</tbody>
</table>
<h3 id="函数-open-和-openat"><a href="#函数-open-和-openat" class="headerlink" title="函数 open 和 openat"></a>函数 open 和 openat</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fcntl.h&gt; 控制文件I/O</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">open</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *path, <span class="keyword">int</span> oflag, ... <span class="comment">/*mode_t mde */</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">openat</span><span class="params">(<span class="keyword">int</span> fd, <span class="keyword">const</span> <span class="keyword">char</span> *path, <span class="keyword">int</span> oflag, ... <span class="comment">/* mode_t mode */</span>)</span></span></span><br></pre></td></tr></table></figure>
<h4 id="open-和-openat-的区别"><a href="#open-和-openat-的区别" class="headerlink" title="open 和 openat 的区别"></a>open 和 openat 的区别</h4><ol>
<li>path 是绝对路径名时， fd 参数被忽略</li>
<li>path 参数指定的是相对路径名，fd 参数指出了相对路径名所在文件系统中的开始地址。</li>
<li>path 参数指定的是相对路径名，fd 的参数具有特殊值 <code>AT_FDCWD</code> 。这时open 和 openat 函数类似。</li>
</ol>
<p><a href="https://linux.die.net/man/3/open" target="_blank" rel="noopener">oflag 参考链接</a></p>
<p>TODO: TOCTTOU</p>
<h4 id="函数-creat"><a href="#函数-creat" class="headerlink" title="函数 creat"></a>函数 creat</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fcntl.h&gt; 控制文件I/O</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">creat</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *path, <span class="keyword">mode_t</span> mode)</span></span>;</span><br><span class="line"><span class="comment">// 返回值： 若成功返回只写打开的文件描述符； 若出错，返回 -1</span></span><br><span class="line"><span class="comment">// 等效为</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">open</span><span class="params">(path，O_WRONLY| O_CREAT | O_TRUNC, mode <span class="comment">/*mode_t mde */</span>)</span></span>;</span><br><span class="line"><span class="comment">// 如今 creat 函数不再常用，早期因为 open 中不支持 O_CREAT 参数。</span></span><br></pre></td></tr></table></figure>
<p>操作系统中，每个进程的文件描述符不同。相互独立。</p>
<h4 id="函数-close"><a href="#函数-close" class="headerlink" title="函数 close"></a>函数 close</h4><p>可以用 close 函数关闭一个打开的文件。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># <span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">close</span><span class="params">(<span class="keyword">int</span> fd)</span></span>;</span><br><span class="line"><span class="comment">// 返回值：成功 返回 0  出错 返回 -1</span></span><br></pre></td></tr></table></figure>
<h4 id="函数-lseek"><a href="#函数-lseek" class="headerlink" title="函数 lseek"></a>函数 lseek</h4><p>lseek 可以显示地为一个文件设置偏移量</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># <span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="keyword">off_t</span> lessk(<span class="keyword">int</span> fd, <span class="keyword">off_t</span> offset, <span class="keyword">int</span> whence);</span><br><span class="line"><span class="comment">// 返回值：成功 返回 新的文件偏移量  出错 返回 -1</span></span><br></pre></td></tr></table></figure>
<p>whence 参数：</p>
<ul>
<li>SEEK_SET 从文件开始处偏移offset 字节</li>
<li>SEEK_CUR 当前值加 offset， offset可正可负</li>
<li>SEEK_END 从文件尾部偏移 offset 个字节， offset可正可负</li>
</ul>
<p>一个问题：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">➜  IO cat lseek_test.c </span><br><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;fcntl.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;unistd.h&gt;</span></span><br><span class="line"></span><br><span class="line">int <span class="function"><span class="title">main</span></span>()&#123;</span><br><span class="line">    int fd = creat(<span class="string">"./test"</span>,0770);</span><br><span class="line">    off_t new_pos = lseek(fd, 19, SEEK_END);</span><br><span class="line">    write(fd, <span class="string">"test\n"</span>, 24);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, new_pos);</span><br><span class="line">    new_pos = lseek(fd, 19, SEEK_CUR);</span><br><span class="line">    write(fd, <span class="string">"test\n"</span>, 24);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, new_pos);</span><br><span class="line">    new_pos = lseek(fd, 19, SEEK_END);</span><br><span class="line">    write(fd, <span class="string">"test\n"</span>, 24);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, new_pos);</span><br><span class="line">    <span class="built_in">return</span> 0;</span><br><span class="line">&#125;</span><br><span class="line">➜  IO gcc lseek_test.c  -o lseek_test</span><br><span class="line">➜  IO ./lseek_test </span><br><span class="line">19</span><br><span class="line">62</span><br><span class="line">105</span><br><span class="line">➜  IO cat <span class="built_in">test</span> </span><br><span class="line"><span class="built_in">test</span></span><br><span class="line">%d</span><br><span class="line">4test</span><br><span class="line">%d</span><br><span class="line">4test</span><br><span class="line">%d</span><br><span class="line">4%                                                                                                                  ➜  IO od -c <span class="built_in">test</span>                     </span><br><span class="line">0000000  \0  \0  \0  \0  \0  \0  \0  \0  \0  \0  \0  \0  \0  \0  \0  \0</span><br><span class="line">0000020  \0  \0  \0   t   e   s   t  \n  \0   %   d  \n  \0  \0  \0  \0</span><br><span class="line">0000040 001 033 003   ;   4  \0  \0  \0 005  \0  \0  \0  \0  \0  \0  \0</span><br><span class="line">0000060  \0  \0  \0  \0  \0  \0  \0  \0  \0  \0  \0  \0  \0  \0   t   e</span><br><span class="line">0000100   s   t  \n  \0   %   d  \n  \0  \0  \0  \0 001 033 003   ;   4</span><br><span class="line">0000120  \0  \0  \0 005  \0  \0  \0  \0  \0  \0  \0  \0  \0  \0  \0  \0</span><br><span class="line">0000140  \0  \0  \0  \0  \0  \0  \0  \0  \0   t   e   s   t  \n  \0   %</span><br><span class="line">0000160   d  \n  \0  \0  \0  \0 001 033 003   ;   4  \0  \0  \0 005  \0</span><br><span class="line">0000200  \0</span><br><span class="line">0000201</span><br><span class="line"></span><br><span class="line">➜  IO od -h <span class="built_in">test</span>    </span><br><span class="line">0000000 0000 0000 0000 0000 0000 0000 0000 0000</span><br><span class="line">0000020 0000 7400 7365 0a74 2500 0a64 0000 0000</span><br><span class="line">0000040 1b01 3b03 0034 0000 0005 0000 0000 0000</span><br><span class="line">0000060 0000 0000 0000 0000 0000 0000 0000 6574</span><br><span class="line">0000100 7473 000a 6425 000a 0000 0100 031b 343b</span><br><span class="line">0000120 0000 0500 0000 0000 0000 0000 0000 0000</span><br><span class="line">0000140 0000 0000 0000 0000 7400 7365 0a74 2500</span><br><span class="line">0000160 0a64 0000 0000 1b01 3b03 0034 0000 0005</span><br><span class="line">0000200 0000</span><br><span class="line">0000201</span><br></pre></td></tr></table></figure>
<p>空洞的文件里面还有填充着 <code>1b01 3b03 0034</code>, 不知道这个是什么东西。</p>
<p>奇怪的 printf</p>
<h4 id="函数-read"><a href="#函数-read" class="headerlink" title="函数 read"></a>函数 read</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># <span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="keyword">ssize_t</span> read(<span class="keyword">int</span> fd, <span class="keyword">void</span> *buf, <span class="keyword">size_t</span> nbytes);</span><br><span class="line"><span class="comment">// 返回值：成功 返回 读到的字节数，文件尾，返回0  出错 返回 -1</span></span><br></pre></td></tr></table></figure>
<h4 id="函数-write"><a href="#函数-write" class="headerlink" title="函数 write"></a>函数 write</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># <span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="keyword">ssize_t</span> wirte(<span class="keyword">int</span> fd, <span class="keyword">const</span> <span class="keyword">void</span> *buf, <span class="keyword">size_t</span> nbytes);</span><br><span class="line"><span class="comment">// 返回值：成功 返回已经写的字符数，返回0  出错 返回 -1</span></span><br></pre></td></tr></table></figure>
<h3 id="I-O-的效率"><a href="#I-O-的效率" class="headerlink" title="I/O 的效率"></a>I/O 的效率</h3><p>缓冲区长度 32字节的时候已经足够好了</p>
<p>TODO: 自己做一下测试</p>
<h3 id="文件共享"><a href="#文件共享" class="headerlink" title="文件共享"></a>文件共享</h3><p>UNIX 支持不同进程间共享打开文件。</p>
<h3 id="原子操作"><a href="#原子操作" class="headerlink" title="原子操作"></a>原子操作</h3><h4 id="不支持原子操作实例："><a href="#不支持原子操作实例：" class="headerlink" title="不支持原子操作实例："></a>不支持原子操作实例：</h4><p>早期 UNIX不支持　O_APPEND 实现 append 操作需要：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (lseek(fd, OL, SEEK_END) &lt; <span class="number">0</span>) <span class="comment">/*position to EOF */</span></span><br><span class="line">    err_sys(<span class="string">"lseek error"</span>);</span><br><span class="line"><span class="keyword">if</span> (write(fs, buf, <span class="number">100</span>) != <span class="number">100</span>)	<span class="comment">/*and write*/</span></span><br><span class="line">    err_sys(<span class="string">"write error"</span>);</span><br></pre></td></tr></table></figure>
<p>在多进程中，如果在 lseek 后发生了进程的切换，那么就有很大可能发生文件的写入覆盖错误。</p>
<h4 id="函数-pread-与-pwrite"><a href="#函数-pread-与-pwrite" class="headerlink" title="函数 pread 与 pwrite"></a>函数 pread 与 pwrite</h4><p>pread 与 pwrite 支持原子操作</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="keyword">ssize_t</span> pread(<span class="keyword">int</span> fd, <span class="keyword">void</span> *buf, <span class="keyword">size_t</span> nbytes, <span class="keyword">off_t</span> offset);</span><br><span class="line"><span class="keyword">ssize_t</span> pwrite(<span class="keyword">int</span> fd, <span class="keyword">const</span> <span class="keyword">void</span> *buf, <span class="keyword">size_t</span> nbytes, <span class="keyword">off_t</span> offset);</span><br></pre></td></tr></table></figure>
<p>PS. 不更新文件偏移量</p>
<h4 id="创建文件"><a href="#创建文件" class="headerlink" title="创建文件"></a>创建文件</h4><p>TODO: 坑 待填</p>
<h3 id="函数-dup-和-dup2"><a href="#函数-dup-和-dup2" class="headerlink" title="函数 dup 和 dup2"></a>函数 dup 和 dup2</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dup</span><span class="params">(<span class="keyword">int</span> fd)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dup2</span><span class="params">(<span class="keyword">int</span> fd, <span class="keyword">int</span> fd2)</span></span>;</span><br><span class="line"><span class="comment">// 返回值：成功 返回新的文件描述符 出错 返回 -1</span></span><br></pre></td></tr></table></figure>
<p>实验：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">➜  IO cat -n dup_test.c            </span><br><span class="line">     1	<span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line">     2	<span class="comment">#include &lt;unistd.h&gt;</span></span><br><span class="line">     3	</span><br><span class="line">     4	int <span class="function"><span class="title">main</span></span>()&#123;</span><br><span class="line">     5	    dup2(1, 0); //自己定义文件描述符，更改标准输入输出</span><br><span class="line">     6	    write(0,<span class="string">"test"</span>,100);</span><br><span class="line">     7	    <span class="built_in">return</span> 0;</span><br><span class="line">     8	&#125;</span><br><span class="line">➜  IO ./dup_test </span><br><span class="line"><span class="built_in">test</span>���dD���L=����t���������zRx����/%</span><br></pre></td></tr></table></figure>
<h3 id="函数-sync，fsync-和-fdatasync"><a href="#函数-sync，fsync-和-fdatasync" class="headerlink" title="函数 sync，fsync 和 fdatasync"></a>函数 sync，fsync 和 fdatasync</h3><p>功能： 保持文件在高速缓存与磁盘同步，数据一致性。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fsync</span><span class="params">(<span class="keyword">int</span> fd)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fatasync</span><span class="params">(<span class="keyword">int</span> fd)</span></span>;</span><br><span class="line">			<span class="comment">// 返回值：成功 ，返回0  出错 返回 -1</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sync</span><span class="params">(<span class="keyword">void</span>)</span></span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>sync  将所有修改过的块缓冲区排入写队列，然后就返回</li>
<li>fsync 当前 fd 的数据，及时写入磁盘，完成之后才会返回</li>
<li>fdatasync 和fsync类似，不过还更新 文件属性</li>
</ul>
<h3 id="函数-fcntl"><a href="#函数-fcntl" class="headerlink" title="函数 fcntl"></a>函数 fcntl</h3><p>fcntl 函数可以改变一打开文件的属性。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fcntl</span><span class="params">(<span class="keyword">int</span> fd, <span class="keyword">int</span> cmd, ... <span class="comment">/*int arg */</span>)</span></span>;</span><br><span class="line">			<span class="comment">// 返回值：成功 ，返回见下表  出错 返回 -1</span></span><br></pre></td></tr></table></figure>
<p>fcntl函数有5种功能：</p>
<ol>
<li>复制一个现有的描述符（cmd=F_DUPFD）.</li>
<li>获得／设置文件描述符标记(cmd=F_GETFD或F_SETFD).</li>
<li>获得／设置文件状态标记(cmd=F_GETFL或F_SETFL).</li>
<li>获得／设置异步I/O所有权(cmd=F_GETOWN或F_SETOWN).</li>
<li><p>获得／设置记录锁(cmd=F_GETLK,F_SETLK或F_SETLKW).</p>
<p>cmd 选项：</p>
</li>
</ol>
<p>F_DUPFD     返回一个如下描述的(文件)描述符:                            </p>
<ul>
<li><p>最小的大于或等于arg的一个可用的描述符                          </p>
</li>
<li><p>与原始操作符一样的某对象的引用                           　　　　　　　　 </p>
</li>
<li><p>如果对象是文件(file)的话,返回一个新的描述符,这个描述符与arg共享相同的偏移量(offset)                    </p>
</li>
<li><p>相同的访问模式(读,写或读/写)                          </p>
</li>
<li><p>相同的文件状态标志(如:两个文件描述符共享相同的状态标志)                            </p>
</li>
<li><p>与新的文件描述符结合在一起的close-on-exec标志被设置成交叉式访问execve(2)的系统调用                     </p>
</li>
</ul>
<p>F_GETFD      取得与文件描述符fd联合close-on-exec标志,类似FD_CLOEXEC.如果返回值和FD_CLOEXEC进行与运算结果是0的话,文件保持交叉式访问exec(), 否则如果通过exec运行的话,文件将被关闭(arg被忽略)                  </p>
<p>F_SETFD         设置close-on-exec旗标。该旗标以参数arg的FD_CLOEXEC位决定。                   </p>
<p>F_GETFL         取得fd的文件状态标志,如同下面的描述一样(arg被忽略)                    </p>
<p>F_SETFL         设置给arg描述符状态标志,可以更改的几个标志是：O_APPEND， O_NONBLOCK，O_SYNC和O_ASYNC。</p>
<p>F_GETOWN     取得当前正在接收SIGIO或者SIGURG信号的进程id或进程组id,进程组id返回成负值(arg被忽略)                    </p>
<p>F_SETOWN     设置将接收SIGIO和SIGURG信号的进程id或进程组id,进程组id通过提供负值的arg来说明,否则,arg将被认为是进程id</p>
<p>fcntl的返回值：  与命令有关。如果出错，所有命令都返回－1，如果成功则返回某个其他值。下列三个命令有特定返回值：F_DUPFD,F_GETFD,F_GETFL以及F_GETOWN。第一个返回新的文件描述符，第二个返回相应标志，最后一个返回一个正的进程ID或负的进程组ID。</p>
<p><a href="https://www.cnblogs.com/xuyh/p/3273082.html" target="_blank" rel="noopener">参考资料</a></p>
<p>应用实例：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"apue.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span></span><br><span class="line">main(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">int</span>		val;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (argc != <span class="number">2</span>)</span><br><span class="line">		err_quit(<span class="string">"usage: a.out &lt;descriptor#&gt;"</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> ((val = fcntl(atoi(argv[<span class="number">1</span>]), F_GETFL, <span class="number">0</span>)) &lt; <span class="number">0</span>)</span><br><span class="line">		err_sys(<span class="string">"fcntl error for fd %d"</span>, atoi(argv[<span class="number">1</span>]));</span><br><span class="line"></span><br><span class="line">	<span class="keyword">switch</span> (val &amp; O_ACCMODE) &#123;</span><br><span class="line">	<span class="keyword">case</span> O_RDONLY:</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"read only"</span>);</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">case</span> O_WRONLY:</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"write only"</span>);</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">case</span> O_RDWR:</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"read write"</span>);</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">default</span>:</span><br><span class="line">		err_dump(<span class="string">"unknown access mode"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (val &amp; O_APPEND)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">", append"</span>);</span><br><span class="line">	<span class="keyword">if</span> (val &amp; O_NONBLOCK)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">", nonblocking"</span>);</span><br><span class="line">	<span class="keyword">if</span> (val &amp; O_SYNC)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">", synchronous writes"</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> !defined(_POSIX_C_SOURCE) &amp;&amp; defined(O_FSYNC) &amp;&amp; (O_FSYNC != O_SYNC)</span></span><br><span class="line">	<span class="keyword">if</span> (val &amp; O_FSYNC)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">", synchronous writes"</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">putchar</span>(<span class="string">'\n'</span>);</span><br><span class="line">	<span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="函数-ioctl"><a href="#函数-ioctl" class="headerlink" title="函数 ioctl"></a>函数 ioctl</h3><p>I/O 操作杂货箱</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/ioctl.h&gt; /* BSD and Linux */</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;   /* System V */</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ioctl</span><span class="params">(<span class="keyword">int</span> fd, <span class="keyword">int</span> request, ...)</span></span>;</span><br></pre></td></tr></table></figure>
<p>TODO: 后面会有详解，这里先不在详细说明</p>
<h3 id="dev-fd"><a href="#dev-fd" class="headerlink" title="/dev/fd"></a>/dev/fd</h3><p> 文件标识符</p>
<h3 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h3><ol>
<li><p>关于lseek 与 append 的冲突</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> fd = open(<span class="string">"./test"</span>, O_RDWR | O_APPEND, <span class="number">0770</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n&gt;&gt;&gt;"</span>,lseek(fd,<span class="number">-35</span>, SEEK_END));</span><br><span class="line">    write(fd,<span class="string">"********"</span>,<span class="number">10</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 结果，只能把内容写到文件末尾</span></span><br></pre></td></tr></table></figure>
<p>2.fork 中 father 与 child 的运行顺序</p>
<ol>
<li>先运行完 father 然后再运行 child 除非 father wait</li>
<li>write 函数，不管数组是否越界，只是个写</li>
</ol>
</li>
</ol>
<p>dw文件I/O</p>

      
    </div>
    
    
    

    

    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>Post author:</strong>
    toads
  </li>
  <li class="post-copyright-link">
    <strong>Post link:</strong>
    <a href="http://toads.github.io/2019/05/04/UNIX环境高级编程读书笔记-三/" title="UNIX环境高级编程读书笔记-三">http://toads.github.io/2019/05/04/UNIX环境高级编程读书笔记-三/</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice: </strong>
    All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> unless stating additionally.
  </li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/unix/" rel="tag"># unix</a>
          
            <a href="/tags/读书笔记/" rel="tag"># 读书笔记</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/05/03/UNIX环境高级编程读书笔记-二/" rel="next" title="UNIX环境高级编程读书笔记(二)">
                <i class="fa fa-chevron-left"></i> UNIX环境高级编程读书笔记(二)
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/05/04/hello-world/" rel="prev" title="Hello World">
                Hello World <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">toads</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/toads" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#第三章-文件I-O"><span class="nav-number">1.</span> <span class="nav-text">第三章  文件I/O</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#文件描述符"><span class="nav-number">1.0.1.</span> <span class="nav-text">文件描述符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#函数-open-和-openat"><span class="nav-number">1.0.2.</span> <span class="nav-text">函数 open 和 openat</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#open-和-openat-的区别"><span class="nav-number">1.0.2.1.</span> <span class="nav-text">open 和 openat 的区别</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#函数-creat"><span class="nav-number">1.0.2.2.</span> <span class="nav-text">函数 creat</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#函数-close"><span class="nav-number">1.0.2.3.</span> <span class="nav-text">函数 close</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#函数-lseek"><span class="nav-number">1.0.2.4.</span> <span class="nav-text">函数 lseek</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#函数-read"><span class="nav-number">1.0.2.5.</span> <span class="nav-text">函数 read</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#函数-write"><span class="nav-number">1.0.2.6.</span> <span class="nav-text">函数 write</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#I-O-的效率"><span class="nav-number">1.0.3.</span> <span class="nav-text">I/O 的效率</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#文件共享"><span class="nav-number">1.0.4.</span> <span class="nav-text">文件共享</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#原子操作"><span class="nav-number">1.0.5.</span> <span class="nav-text">原子操作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#不支持原子操作实例："><span class="nav-number">1.0.5.1.</span> <span class="nav-text">不支持原子操作实例：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#函数-pread-与-pwrite"><span class="nav-number">1.0.5.2.</span> <span class="nav-text">函数 pread 与 pwrite</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#创建文件"><span class="nav-number">1.0.5.3.</span> <span class="nav-text">创建文件</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#函数-dup-和-dup2"><span class="nav-number">1.0.6.</span> <span class="nav-text">函数 dup 和 dup2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#函数-sync，fsync-和-fdatasync"><span class="nav-number">1.0.7.</span> <span class="nav-text">函数 sync，fsync 和 fdatasync</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#函数-fcntl"><span class="nav-number">1.0.8.</span> <span class="nav-text">函数 fcntl</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#函数-ioctl"><span class="nav-number">1.0.9.</span> <span class="nav-text">函数 ioctl</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#dev-fd"><span class="nav-number">1.0.10.</span> <span class="nav-text">/dev/fd</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MISC"><span class="nav-number">1.0.11.</span> <span class="nav-text">MISC</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2018 &mdash; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">toads</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a></div>





  <script src="https://unpkg.com/mermaid@<%= theme.mermaid.version %>/dist/mermaid.min.js"></script>
    <script>
    if (window.mermaid) {
              mermaid.initialize({theme: 'forest'});
                  
    }
      </script>
      

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  

    
      <script id="dsq-count-scr" src="https://toads.disqus.com/count.js" async></script>
    

    
      <script type="text/javascript">
        var disqus_config = function () {
          this.page.url = 'http://toads.github.io/2019/05/04/UNIX环境高级编程读书笔记-三/';
          this.page.identifier = '2019/05/04/UNIX环境高级编程读书笔记-三/';
          this.page.title = 'UNIX环境高级编程读书笔记-三';
        };
        var d = document, s = d.createElement('script');
        s.src = 'https://toads.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);
      </script>
    

  




	





  














  





  

  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

<script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
